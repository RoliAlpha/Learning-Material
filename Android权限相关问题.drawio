<mxfile host="app.diagrams.net" modified="2024-04-02T02:52:05.638Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36" etag="mP692ZzH6S3uRQehT0oz" version="24.2.1" type="github">
  <diagram name="第 1 页" id="d8uDb4fDx_4ov-rtAS1f">
    <mxGraphModel dx="1434" dy="764" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <UserObject label="&lt;h1 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 2.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.2; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain md-expand&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android权限相关问题&lt;/span&gt;&lt;/h1&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;前言&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android权限问题在不太了解之前是很烦人的，尤其是跟随着Android系统版本的更新，相关的权限申请也在不停的变化，当应用需要同时兼容新老版本跨度较大时就很容易因为这些问题造成无法正常工作。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;所以，首先要了解Android版本和SDK的关系，帮助我们分辨后面的权限版本。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;其次把最常见的Android7-13版本的我们需要注意的权限问题聊一下。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;最后是现在App都需要的动态申请权限的工具使用。&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;一、Android版本和SDK版本的关系&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;目前最新的Android版本已经到了Android 14，相应的SDK版本也达到了34.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span data-src=&quot;https://img-blog.csdnimg.cn/direct/8f15384412154c5cb607d75c12758109.png&quot; class=&quot;md-image md-img-loaded&quot; style=&quot;box-sizing: border-box; min-width: 10px; min-height: 10px; position: relative; word-break: break-all; font-family: monospace; vertical-align: top; display: inline-block; width: 800px;&quot;&gt;&lt;img alt=&quot;img&quot; src=&quot;https://img-blog.csdnimg.cn/direct/8f15384412154c5cb607d75c12758109.png&quot; style=&quot;box-sizing: border-box; border-width: 0px 4px 0px 2px; border-top-style: initial; border-right-style: solid; border-bottom-style: initial; border-left-style: solid; border-top-color: initial; border-right-color: transparent; border-bottom-color: initial; border-left-color: transparent; border-image: initial; vertical-align: middle; max-width: 100%; image-orientation: from-image; cursor: default; display: block; margin: auto;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;二、Android版本变化中权限的变化&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这里说一下比较明显变化的版本，还有最近几个版本的变化：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;ul-list&quot; data-mark=&quot;-&quot; style=&quot;box-sizing: border-box; margin: 0.8em 0px; padding-left: 30px; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li class=&quot;md-list-item&quot; style=&quot;box-sizing: border-box; margin: 0px; position: relative;&quot;&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px 0px 0.5rem; white-space: pre-wrap; position: relative;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;众所周知Android5.1 -&amp;gt; Android6.0的权限变化。可以看到Android5.1到Android6.0的权限变化，也就是对应着我们的SDK23版本。也就是说当build.gradle中targetSdkVersion设置小于23时，会继续引用旧版本权限管理机制，当targetSdkVersion大于等于23时，则会使用新的权限管理。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、Android5以前 — targetSdkVersion &amp;lt; 23&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;当targetSdkVersion小于23时，你的项目会继续使用旧版本的权限机制：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;所申请的权限只需要在AndroidManifest.xml列举就可以（如下），从而容易导致一些安全隐患：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span data-src=&quot;https://img-blog.csdnimg.cn/85ff578b1fa44ccbbdd81250c9e3a526.png&quot; class=&quot;md-image md-img-loaded&quot; style=&quot;box-sizing: border-box; min-width: 10px; min-height: 10px; position: relative; word-break: break-all; font-family: monospace; vertical-align: top; display: inline-block; width: 800px;&quot;&gt;&lt;img alt=&quot;在这里插入图片描述&quot; src=&quot;https://img-blog.csdnimg.cn/85ff578b1fa44ccbbdd81250c9e3a526.png&quot; style=&quot;box-sizing: border-box; border-width: 0px 4px 0px 2px; border-top-style: initial; border-right-style: solid; border-bottom-style: initial; border-left-style: solid; border-top-color: initial; border-right-color: transparent; border-bottom-color: initial; border-left-color: transparent; border-image: initial; vertical-align: middle; max-width: 100%; image-orientation: from-image; cursor: default; display: block; margin: auto;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、用户在安装时获取到所有权限，在使用权限时无需进行预判断。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、如果用户手动来到设置将权限关闭，我们的项目在用到该权限时会发生Crash，所以如果使用低版本权限管理，请将需要用到权限的地方try-catch起来。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、低版本权限提示弹窗都是ROM厂商自定义的。他们拥有系统权限，在检测到你的App使用权限时会提示用户权限授权，如果用户拒绝则替用户到设置中心关闭权限。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、Android6 — targetSdkVersion23&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、将权限分为了&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;普通权限&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;和&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;隐私权限&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;普通权限在清单文件中声明则直接获取&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;隐私权限也需要在清单文件中声明，但是在安装完成后，所有的隐私权限都为拒绝状态，需要在用到隐私权限时判断权限是否开启，否则项目直接发生Crash&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;比如常用的隐私权限：相机、定位、打电话、短信、读写存储、麦克风录音、传感器。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span data-src=&quot;https://img-blog.csdnimg.cn/cf84298b2b0e430a8dacdd79d5261ad5.png&quot; class=&quot;md-image md-img-loaded&quot; style=&quot;box-sizing: border-box; min-width: 10px; min-height: 10px; position: relative; word-break: break-all; font-family: monospace; vertical-align: top; display: inline-block; width: 800px;&quot;&gt;&lt;img alt=&quot;隐私权限&quot; src=&quot;https://img-blog.csdnimg.cn/cf84298b2b0e430a8dacdd79d5261ad5.png&quot; style=&quot;box-sizing: border-box; border-width: 0px 4px 0px 2px; border-top-style: initial; border-right-style: solid; border-bottom-style: initial; border-left-style: solid; border-top-color: initial; border-right-color: transparent; border-bottom-color: initial; border-left-color: transparent; border-image: initial; vertical-align: middle; max-width: 100%; image-orientation: from-image; cursor: default; display: block; margin: auto;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;上图中有一个权限群的概念，同一组的任何一个权限被授权了，其他权限也自动被授权。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;例如，一旦WRITE_EXTERNAL_STORAGE被授权了，APP同时也就有了READ_EXTERNAL_STORAGE权限。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;申请权限的步骤&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、在AndroidManifest.xml声明&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、检查我们未授权的权限checkSelfPermission(Context context, String permission)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、申请我们的权限requestPermissions(Activity activity, String[] permissions, int requestCode)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4、申请权限的结果onRequestPermissionsResult(int requestCode, String[] permissions, String[] grantResults)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;5、后续就是自己处理逻辑了&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、Android7 — targetSdkVersion24、25&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;为了提高私有目录的安全性，防止应用信息的泄漏，从 Android 7.0 开始，应用私有目录的访问权限被做限制。具体表现为，开发人员不能够再简单地通过 file:// URI 访问其他应用的私有目录文件或者让其他应用访问自己的私有目录文件。会触发 FileUriExposedException的错误异常。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;解决办法：使用FileProvider（具体使用不做赘述了）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;作为四大组件之一的 ContentProvider，一直扮演着应用间共享资源的角色。这里我们要使用到的 FileProvider，就是 ContentProvider 的一个特殊子类，帮助我们将访问受限的 file:// URI 转化为可以授权共享的 content:// URI。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4、Android8 — targetSdkVersion26、27&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android 8.0 之前，如果应用在运行时请求权限并且被授予该权限，系统会错误地将属于同一权限组并且在清单中注册的其他权限也一起授予应用。（上面有提到权限组）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;对于针对 Android 8.0 的应用，此行为已被纠正。系统只会授予应用明确请求的权限。然而，一旦用户为应用授予某个权限，则所有后续对该权限组中权限的请求都将被自动批准。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;出现的问题大家也就知道了，就是之前申请了READ_EXTERNAL_STORAGE相应的WRITE_EXTERNAL_STORAGE也会申请，而现在不可以。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;解决方案：之前没动态申请WRITE_EXTERNAL_STORAGE的再加入申请权限列表中申请就可以了。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;但是这里READ_EXTERNAL_STORAGE，WRITE_EXTERNAL_STORAGE是一个权限组，所以申请的时候也只是提示你同意一个存储权限就可以了。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;5、Android10 — targetSdkVersion29&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;重点来了：作用域存储&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;（因为这是最容易遇到兼容性问题的地方）&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这个新功能直接颠覆了长久以来我们一直惯用的外置存储空间的使用方式，因此应用在需要运行在多系统版本的环境时，就需要实时根据当前系统版本做出相应的逻辑调整。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android长久以来都支持外置存储空间这个功能，也就是我们常说的SD卡存储。故App都喜欢在SD卡的根目录下建立一个自己专属的目录，用来存放各类文件和数据。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;优点：第一，存储在SD卡的文件不会计入到应用程序的占用空间当中，也就是说即使你在SD卡存放了1G的文件，你的应用程序在设置中显示的占用空间仍然可能只有几十K。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二，存储在SD卡的文件，即使应用程序被卸载了，这些文件仍然会被保留下来，这有助于实现一些需要数据被永久保留的功能。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;缺点：第一，流氓行为，即使我卸载了一个完全不再使用的程序，它所产生的垃圾文件却可能会一直保留在我的手机上&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二，存储在SD卡上的文件属于公有文件，所有的应用程序都有权随意访问，这也对数据的安全性带来了很大的挑战。（这种流氓行为Google他出手了，也就是作用域存储）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Google的作用域到底是什么：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 10开始，每个应用程序只能有权在自己的外置存储空间关联目录下读取和创建文件。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;获取该目录的代码为：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;context&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getExternalFilesDir&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// storage/emulated/0/Android/data/&amp;lt;包名&amp;gt;/files（大概目录为）&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;将数据存放到这个目录下，你将可以完全使用之前的写法来对文件进行读写，不需要做任何变更和适配。但同时，刚才提到的那两个“好处”也就不存在了。也就是应用删除相关存储也会消失。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;那么有些朋友可能会问了，我就是需要访问其他目录该怎么办呢？比如读取手机相册中的图片，或者向手机相册中添加一张图片。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;为此，Android系统针对文件类型进行了分类，图片、音频、视频这三类文件将可以通过MediaStore API来进行访问，而其他类型的文件则需要使用系统的文件选择器来进行访问。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;具体的适配Android10的解决方案写在下面了。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;7、Android11 — targetSdkVersion30&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;如果按照Android10的解决方案进行适配了，那么就什么都不需要做。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;如果是暂时的设置了requestLegacyExternalStorage=“true”&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt; ... &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;requestLegacyExternalStorage&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt; ...&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;那么恭喜你：Scoped Storage就会被强制启用。也就是requestLegacyExternalStorage设置无效。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;解决方案：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、按照Android10的解决方案进行适配（最好适配了。不然后续版本也要不断修改）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、你必须在AndroidManifest.xml中声明MANAGE_EXTERNAL_STORAGE权限&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;tools&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ignore&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;ScopedStorage&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;注意相比于传统声明一个权限，这里增加了tools:ignore=&quot;ScopedStorage&quot;这样一个属性。因为如果不加上这个属性，Android Studio会用一个警告提醒我们，绝大部分的应用程序都不应该申请这个权限。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;之后利用ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION这个action来跳转到指定的授权页面，进行授权。（所以还是去适配Android10的解决方案吧）&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;SDK_INT&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION_CODES&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;isExternalStorageManager&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;makeText&lt;/span&gt;(&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;已获得访问所有文件权限&quot;&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;LENGTH_SHORT&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;show&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;} &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;builder&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;AlertDialog&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Builder&lt;/span&gt;(&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  .&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setMessage&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;本程序需要您同意允许访问所有文件权限&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  .&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setPositiveButton&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;确定&quot;&lt;/span&gt;) { &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;_&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Intent&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Settings&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;startActivity&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;builder&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;show&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;8、Android13 — targetSdkVersion33&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、Google在Android 13上对本地数据访问权限做了更进一步的细化&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 13开始，如果你的应用targetSdk指定到了33或以上，那么READ_EXTERNAL_STORAGE权限就完全失去了作用，申请它将不会产生任何的效果。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;相对应地，Google新增了READ_MEDIA_IMAGES、READ_MEDIA_VIDEO和READ_MEDIA_AUDIO这3个运行时权限，分别用于管理手机的照片、视频和音频文件。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;也就是说，以前只要申请一个READ_EXTERNAL_STORAGE权限就可以了。现在不行了，得按需申请，用户从而能够更加精细地了解你的应用到底申请了哪些媒体权限。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.READ_MEDIA_IMAGES&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.READ_MEDIA_AUDIO&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.READ_MEDIA_VIDEO&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、通知运行时权限&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在之前的Android系统中，任何一个应用想要发出通知的话都是不需要经过用户同意的，想发就能发。这就使得我们的手机通知栏经常被一些垃圾通知占领&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这次Android 13则把通知纳入了运行时权限管理，也就是说，以后想要发送通知，得要先经过用户同意授权才行了。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.POST_NOTIFICATIONS&quot;&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;WIFI运行时权限&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;和蓝牙类似，当开发者去访问一些WIFI相关的接口时，如热点、WIFI直连、WIFI RTT等，也需要申请地理位置权限才行。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android 13当中新增了一个NEARBY_WIFI_DEVICES权限，当再使用以上场景相关的WIFI API时，我们只需申请NEARBY_WIFI_DEVICES权限即可，从而更好地保护了用户的隐私。&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;三、Android10以上存储权限适配&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、临时解决方案(仅适合适配到Android10)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;临时解决方案仅仅适合在Android10上解决问题，到了Android11都是不允许的。也就是你的targetSdkVersion升级到了30就需要重新适配。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android10的临时解决方法很简单，只需要在AndroidManifest.xml中加入如下配置即可：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt; ... &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;requestLegacyExternalStorage&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt; ...&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这段配置表示，即使在Android 10系统上，仍然允许使用之前遗留的外置存储空间的用法来运行程序，这样就不用对代码进行任何修改了。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、首先是作用域存储(上面讲到了，就不赘述)&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;简单来说就是把你原来用的获取SD卡根目录随意存储的方式，换成自己的外置存储目录。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;原来的：获取后创建自己想要的文件夹存储（Android10以上是不可以了，也就是你targetSdkVersion &amp;gt;= 29）&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getExternalStorageDirectory&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// storage/emulated/0 （正常获取的默认目录）&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;修改为：自己的外置存储空间，这就可以进行存储了&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;context&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getExternalFilesDir&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// storage/emulated/0/Android/data/&amp;lt;包名&amp;gt;/files （获取的默认目录）&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、读取手机相册、视频、音频&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这里只举例图片，视频和音频是一样的方式获取。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;不同于过去可以直接获取到相册中图片的绝对路径，在作用域存储当中，我们只能借助MediaStore API获取到图片的Uri，示例代码如下：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;query&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Images&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Media&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;${MediaStore.MediaColumns.DATE_ADDED} desc&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;moveToNext&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getLong&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getColumnIndexOrThrow&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;_ID&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ContentUris&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;withAppendedId&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Images&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Media&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;println&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;image uri is $uri&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;close&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;上述代码中，我们先是通过ContentResolver获取到了相册中所有图片的id，然后再借助ContentUris将id拼装成一个完整的Uri对象。一张图片的Uri格式大致如下所示：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;content&lt;/span&gt;:&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;//media/external/images/media/321&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;那么有些朋友可能会问了，获取到了Uri之后，我又该怎样将这张图片显示出来呢？这就有很多种办法了，比如使用Glide来加载图片，它本身就支持传入Uri对象来作为图片路径：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Glide&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;with&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;context&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;load&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;into&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;imageView&lt;/span&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4、添加图片到相册(视频、音频)&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;将一张图片添加到手机相册要相对稍微复杂一点&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;直接上代码：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第一步：构建一个ContentValues对象&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二步：添加他的三个参数一个是图片显示的名称：DISPLAY_NAME。一个是图片的mime类型：MIME_TYPE。还有一个是图片存储的路径，不过这个值在Android 10和之前的系统版本中的处理方式不一样。Android 10中新增了一个RELATIVE_PATH常量，表示文件存储的相对路径，可选值有DIRECTORY_DCIM、DIRECTORY_PICTURES、DIRECTORY_MOVIES、DIRECTORY_MUSIC等，分别表示相册、图片、电影、音乐等目录。而在之前的系统版本中并没有RELATIVE_PATH，所以我们要使用DATA常量（已在Android 10中废弃），并拼装出一个文件存储的绝对路径才行。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第三步：调用ContentResolver的insert()方法即可获得插入图片的Uri。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第四步：调用ContentResolver的openOutputStream()方法获得文件的输出流，然后将Bitmap对象写入到该输出流当中即可。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;addBitmapToAlbum&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;bitmap&lt;/span&gt;: &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Bitmap&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;displayName&lt;/span&gt;: &lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;mimeType&lt;/span&gt;: &lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;compressFormat&lt;/span&gt;: &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Bitmap&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;CompressFormat&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ContentValues&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DISPLAY_NAME&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;displayName&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MIME_TYPE&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;mimeType&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;SDK_INT&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION_CODES&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Q&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;RELATIVE_PATH&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DIRECTORY_DCIM&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  } &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DATA&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;${Environment.getExternalStorageDirectory().path}/${Environment.DIRECTORY_DCIM}/$displayName&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;insert&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Images&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Media&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;openOutputStream&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;bitmap&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;compress&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;compressFormat&lt;/span&gt;, &lt;span class=&quot;cm-number&quot; style=&quot;box-sizing: border-box; color: rgb(17, 102, 68);&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;close&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;5、下载文件到Download目录&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;执行文件下载操作是一个很常见的场景，比如说下载pdf、doc文件，或者下载APK安装包等等。在过去，这些文件我们通常都会下载到Download目录，这是一个专门用于存放下载文件的目录。而从Android 10开始，我们已经不能以绝对路径的方式访问外置存储空间了，所以文件下载功能也会受到影响。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第一种解决方法：同时也是最简单的一种方式，就是更改文件的下载目录。将文件下载到应用程序的关联目录下，这样不用修改任何代码就可以让程序在Android 10系统上正常工作。但使用这种方式，你需要知道，下载的文件会被计入到应用程序的占用空间当中，同时如果应用程序被卸载了，该文件也会一同被删除。另外，存放在关联目录下的文件只能被当前的应用程序所访问，其他程序是没有读取权限的。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二种解决方案：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;将文件下载到Download目录，和向相册中添加一张图片的过程是差不多的，Android 10在MediaStore中新增了一种Downloads集合，专门用于执行文件下载操作。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ContentValues&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DISPLAY_NAME&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;fileName&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;RELATIVE_PATH&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DIRECTORY_DOWNLOADS&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;insert&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Downloads&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;其余你下载的流程不用改变，只替换你写入文件的部分&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;四、“选择启用”通知的通知权限&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 13开始通知采用“选择启用”模式，这与旧版 Android 不同，旧版 Android 采用的是“选择停用”模式。在 Android 13 中，所有应用必须先请求用户授予权限，然后才能发送通知提示。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;实现“选择启用”通知功能所需的变更&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从 Android 13 开始，应用必须先向系统请求 &lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.com/about/versions/13/changes/notification-permission?hl=zh-cn&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;android.permission.POST_NOTIFICATION&lt;/code&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 运行时权限，以声明发送通知的意图，然后才能发送通知。&lt;/span&gt;&lt;/p&gt;&lt;figure class=&quot;md-table-fig&quot; style=&quot;box-sizing: border-box; margin: 1.2em 0px; overflow-x: auto; max-width: calc(100% + 16px); padding: 0px; cursor: default; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;table class=&quot;md-table&quot; style=&quot;box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; width: 800px; overflow: auto; break-inside: auto; text-align: left; cursor: text; margin: 0px; padding: 0px; word-break: initial; white-space: pre-wrap;&quot;&gt;&lt;thead style=&quot;box-sizing: border-box; display: table-header-group; background-color: rgb(248, 248, 248);&quot;&gt;&lt;tr class=&quot;md-end-block&quot; style=&quot;box-sizing: border-box; break-inside: avoid; break-after: auto; border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px;&quot;&gt;&lt;th style=&quot;box-sizing: border-box; padding: 6px 13px; border-width: 1px 1px 0px; border-bottom-style: initial; border-bottom-color: initial; font-weight: bold; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; margin: 0px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 74px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;搭载 Android 13 的设备&lt;/span&gt;&lt;/span&gt;&lt;/th&gt;&lt;th style=&quot;box-sizing: border-box; padding: 6px 13px; border-width: 1px 1px 0px; border-bottom-style: initial; border-bottom-color: initial; font-weight: bold; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; margin: 0px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 366px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;以 Android 13 或更高版本为目标平台的应用&lt;/span&gt;&lt;/span&gt;&lt;/th&gt;&lt;th style=&quot;box-sizing: border-box; padding: 6px 13px; border-width: 1px 1px 0px; border-bottom-style: initial; border-bottom-color: initial; font-weight: bold; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; margin: 0px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 278px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;以低于 Android 13 的版本为目标平台的应用&lt;/span&gt;&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody style=&quot;box-sizing: border-box;&quot;&gt;&lt;tr class=&quot;md-end-block&quot; style=&quot;box-sizing: border-box; break-inside: avoid; break-after: auto; border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px;&quot;&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 74px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;新安装&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 366px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至应用发出提示。应用控制何时请求权限。&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 278px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至操作系统发出提示。首次运行应用时，系统会请求权限。&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;md-end-block&quot; style=&quot;box-sizing: border-box; break-inside: avoid; break-after: auto; border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px; background-color: rgb(248, 248, 248);&quot;&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 74px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;现有应用（升级）&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 366px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至应用发出提示。系统将授予临时权限，直至应用在首次符合条件地运行时发出请求。&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 278px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至操作系统发出提示。系统会授予临时权限，直至应用首次运&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;实现：xml文件里声明 + 运行时权限申请&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1.添加通知权限&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在Android 13中，要想唤起通知，首先需要申请对应的通知权限。在应用的清单文件（AndroidManifest.xml）中添加如下代码：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;c++&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt; ...&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.POST_NOTIFICATIONS&quot;&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这样，你的应用就被赋予了显示通知的能力&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2. 动态请求权限&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;不仅仅是在清单文件中添加权限，还需要在显示通知之前进行动态的权限请求。以下是一个示例代码，演示了如何在动态请求权限的过程中确保用户的通知权限：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;kotlin&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;checkPermission&lt;/span&gt;() {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;manager&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getSystemService&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;NOTIFICATION_SERVICE&lt;/span&gt;) &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;NotificationManager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// 检测该应用是否有通知权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;when&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manager&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;areNotificationsEnabled&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&amp;gt;&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;showNotification&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;makeText&lt;/span&gt;(&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;@MainActivity&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;点击了通知按钮&quot;&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;LENGTH_SHORT&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;show&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&amp;gt;&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;requestPermissionLauncher&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;launch&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Manifest&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;POST_NOTIFICATIONS&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在上述代码中，我们通过判断应用是否具备通知权限来决定是否展示通知。如果应用没有通知权限，就会触发动态请求权限的过程。&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3.用户禁止授予权限的情景&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在某些情况下，用户可能会在第一次请求权限时选择禁止。此后，再次尝试动态请求权限就不会弹出请求弹窗。这时，我们只能引导用户手动开启相应的权限。&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4.源码中关于应用通知权限的判断&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android源码中，有一段与权限相关的判断逻辑，它控制了权限的赋予。具体代码如下：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;kotlin&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;grantSignatureAppsNotificationPermissions&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;PackageManagerWrapper&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pm&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;userId&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Log&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;i&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;TAG&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;Granting Notification permissions to platform signature apps for user &quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;userId&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;PackageInfo&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;packages&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;mContext&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getPackageManager&lt;/span&gt;().&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getInstalledPackagesAsUser&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DEFAULT_PACKAGE_INFO_QUERY_FLAGS&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;UserHandle&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;USER_SYSTEM&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;PackageInfo&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt; : &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;packages&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;applicationInfo&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;isSystemApp&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;applicationInfo&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;isSignedWithPlatformKey&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;grantRuntimePermissionsForSystemPackage&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pm&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;userId&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;NOTIFICATION_PERMISSIONS&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;五、跨应用bindService声明软件包可见性&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 11(api30)开始，如果应用需要与其他应用（&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#automatic&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;自动可见的&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;应用除外）交互，请在您应用的清单文件中添加 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素。在 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素中，&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#package-name&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;按软件包名称&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;、&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#intent-signature&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;按 intent 签名&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;或&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#provider-authority&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;按提供程序授权&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;指定其他应用，如以下部分所述。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;官方介绍：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-meta-i-c md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/guide/topics/manifest/queries-element?hl=en&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;queries官方解释&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-meta-i-c md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/about/versions/12/foreground-services?hl=zh_cn&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;前台服务限制_官方&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;具体实现：&lt;/span&gt;&lt;/h3&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;查询特定软件包及与之交互&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;如果知道要查询或与之交互的一组特定应用（例如，与应用集成的另外的应用或您使用其服务的应用），请将其软件包名称添加到 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素内的一组 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;package&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素中：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;xml&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;package&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.test&quot;&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdke&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在给定 intent 过滤器的情况下查询应用及与之交互&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;应用可能需要查询一组具有特定用途的应用或与之交互，但可能不知道要添加的具体软件包名称。在这种情况下，您可以在 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素中列出 &lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/filters&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;intent 过滤器签名&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;。然后，您的应用就可以发现具有匹配的 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;intent-filter&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素的应用。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;XML&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;package&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.test&quot;&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;示例：&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这里只展示部分代码，重点展示如何设置软件包可见性。 &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;服务端AndroidManifest.xml配置&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;xml&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;service&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdk.services.AidlSService&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:enabled&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:exported&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent-filter&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;category&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.intent.category.DEFAULT&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent-filter&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;客户端AndroidManifest.xml配置&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;package 对应服务端的包名，action 对应服务端的name&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;xml&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdk&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;客户端跨应用启动service服务&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;bindAidlService&lt;/span&gt;() {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Intent&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setAction&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setPackage&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdk&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;bindService&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;serviceConnection&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Context&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;BIND_AUTO_CREATE&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Log&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;i&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;TAG&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;bindAidlService: &quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;result&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这些都设置完成之后发现可能还是不能正常工作，可能是一下两个原因：&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;ol-list&quot; style=&quot;box-sizing: border-box; margin: 0.8em 0px; padding-left: 30px; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li class=&quot;md-list-item&quot; style=&quot;box-sizing: border-box; margin: 0px; position: relative;&quot;&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px 0px 0.5rem; white-space: pre-wrap; position: relative;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;后台服务无法由另外一个应用启动，可以改为独立进程的前台服务&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;md-list-item&quot; style=&quot;box-sizing: border-box; margin: 0px; position: relative;&quot;&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px 0px 0.5rem; white-space: pre-wrap; position: relative;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;关联启动权限：需要开启对应服务的关联启动权限&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;br class=&quot;Apple-interchange-newline&quot;&gt;" link="&lt;h1 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 2.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.2; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain md-expand&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android权限相关问题&lt;/span&gt;&lt;/h1&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;前言&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android权限问题在不太了解之前是很烦人的，尤其是跟随着Android系统版本的更新，相关的权限申请也在不停的变化，当应用需要同时兼容新老版本跨度较大时就很容易因为这些问题造成无法正常工作。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;所以，首先要了解Android版本和SDK的关系，帮助我们分辨后面的权限版本。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;其次把最常见的Android7-13版本的我们需要注意的权限问题聊一下。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;最后是现在App都需要的动态申请权限的工具使用。&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;一、Android版本和SDK版本的关系&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;目前最新的Android版本已经到了Android 14，相应的SDK版本也达到了34.&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span data-src=&quot;https://img-blog.csdnimg.cn/direct/8f15384412154c5cb607d75c12758109.png&quot; class=&quot;md-image md-img-loaded&quot; style=&quot;box-sizing: border-box; min-width: 10px; min-height: 10px; position: relative; word-break: break-all; font-family: monospace; vertical-align: top; display: inline-block; width: 800px;&quot;&gt;&lt;img alt=&quot;img&quot; src=&quot;https://img-blog.csdnimg.cn/direct/8f15384412154c5cb607d75c12758109.png&quot; style=&quot;box-sizing: border-box; border-width: 0px 4px 0px 2px; border-top-style: initial; border-right-style: solid; border-bottom-style: initial; border-left-style: solid; border-top-color: initial; border-right-color: transparent; border-bottom-color: initial; border-left-color: transparent; border-image: initial; vertical-align: middle; max-width: 100%; image-orientation: from-image; cursor: default; display: block; margin: auto;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;二、Android版本变化中权限的变化&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这里说一下比较明显变化的版本，还有最近几个版本的变化：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;ul-list&quot; data-mark=&quot;-&quot; style=&quot;box-sizing: border-box; margin: 0.8em 0px; padding-left: 30px; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li class=&quot;md-list-item&quot; style=&quot;box-sizing: border-box; margin: 0px; position: relative;&quot;&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px 0px 0.5rem; white-space: pre-wrap; position: relative;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;众所周知Android5.1 -&amp;gt; Android6.0的权限变化。可以看到Android5.1到Android6.0的权限变化，也就是对应着我们的SDK23版本。也就是说当build.gradle中targetSdkVersion设置小于23时，会继续引用旧版本权限管理机制，当targetSdkVersion大于等于23时，则会使用新的权限管理。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、Android5以前 — targetSdkVersion &amp;lt; 23&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;当targetSdkVersion小于23时，你的项目会继续使用旧版本的权限机制：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;所申请的权限只需要在AndroidManifest.xml列举就可以（如下），从而容易导致一些安全隐患：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span data-src=&quot;https://img-blog.csdnimg.cn/85ff578b1fa44ccbbdd81250c9e3a526.png&quot; class=&quot;md-image md-img-loaded&quot; style=&quot;box-sizing: border-box; min-width: 10px; min-height: 10px; position: relative; word-break: break-all; font-family: monospace; vertical-align: top; display: inline-block; width: 800px;&quot;&gt;&lt;img alt=&quot;在这里插入图片描述&quot; src=&quot;https://img-blog.csdnimg.cn/85ff578b1fa44ccbbdd81250c9e3a526.png&quot; style=&quot;box-sizing: border-box; border-width: 0px 4px 0px 2px; border-top-style: initial; border-right-style: solid; border-bottom-style: initial; border-left-style: solid; border-top-color: initial; border-right-color: transparent; border-bottom-color: initial; border-left-color: transparent; border-image: initial; vertical-align: middle; max-width: 100%; image-orientation: from-image; cursor: default; display: block; margin: auto;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、用户在安装时获取到所有权限，在使用权限时无需进行预判断。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、如果用户手动来到设置将权限关闭，我们的项目在用到该权限时会发生Crash，所以如果使用低版本权限管理，请将需要用到权限的地方try-catch起来。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、低版本权限提示弹窗都是ROM厂商自定义的。他们拥有系统权限，在检测到你的App使用权限时会提示用户权限授权，如果用户拒绝则替用户到设置中心关闭权限。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、Android6 — targetSdkVersion23&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、将权限分为了&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;普通权限&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;和&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;隐私权限&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;，&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;普通权限在清单文件中声明则直接获取&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;隐私权限也需要在清单文件中声明，但是在安装完成后，所有的隐私权限都为拒绝状态，需要在用到隐私权限时判断权限是否开启，否则项目直接发生Crash&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;比如常用的隐私权限：相机、定位、打电话、短信、读写存储、麦克风录音、传感器。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span data-src=&quot;https://img-blog.csdnimg.cn/cf84298b2b0e430a8dacdd79d5261ad5.png&quot; class=&quot;md-image md-img-loaded&quot; style=&quot;box-sizing: border-box; min-width: 10px; min-height: 10px; position: relative; word-break: break-all; font-family: monospace; vertical-align: top; display: inline-block; width: 800px;&quot;&gt;&lt;img alt=&quot;隐私权限&quot; src=&quot;https://img-blog.csdnimg.cn/cf84298b2b0e430a8dacdd79d5261ad5.png&quot; style=&quot;box-sizing: border-box; border-width: 0px 4px 0px 2px; border-top-style: initial; border-right-style: solid; border-bottom-style: initial; border-left-style: solid; border-top-color: initial; border-right-color: transparent; border-bottom-color: initial; border-left-color: transparent; border-image: initial; vertical-align: middle; max-width: 100%; image-orientation: from-image; cursor: default; display: block; margin: auto;&quot;&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;上图中有一个权限群的概念，同一组的任何一个权限被授权了，其他权限也自动被授权。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;例如，一旦WRITE_EXTERNAL_STORAGE被授权了，APP同时也就有了READ_EXTERNAL_STORAGE权限。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;申请权限的步骤&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、在AndroidManifest.xml声明&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、检查我们未授权的权限checkSelfPermission(Context context, String permission)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、申请我们的权限requestPermissions(Activity activity, String[] permissions, int requestCode)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4、申请权限的结果onRequestPermissionsResult(int requestCode, String[] permissions, String[] grantResults)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;5、后续就是自己处理逻辑了&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、Android7 — targetSdkVersion24、25&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;为了提高私有目录的安全性，防止应用信息的泄漏，从 Android 7.0 开始，应用私有目录的访问权限被做限制。具体表现为，开发人员不能够再简单地通过 file:// URI 访问其他应用的私有目录文件或者让其他应用访问自己的私有目录文件。会触发 FileUriExposedException的错误异常。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;解决办法：使用FileProvider（具体使用不做赘述了）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;作为四大组件之一的 ContentProvider，一直扮演着应用间共享资源的角色。这里我们要使用到的 FileProvider，就是 ContentProvider 的一个特殊子类，帮助我们将访问受限的 file:// URI 转化为可以授权共享的 content:// URI。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4、Android8 — targetSdkVersion26、27&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android 8.0 之前，如果应用在运行时请求权限并且被授予该权限，系统会错误地将属于同一权限组并且在清单中注册的其他权限也一起授予应用。（上面有提到权限组）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;对于针对 Android 8.0 的应用，此行为已被纠正。系统只会授予应用明确请求的权限。然而，一旦用户为应用授予某个权限，则所有后续对该权限组中权限的请求都将被自动批准。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;出现的问题大家也就知道了，就是之前申请了READ_EXTERNAL_STORAGE相应的WRITE_EXTERNAL_STORAGE也会申请，而现在不可以。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;解决方案：之前没动态申请WRITE_EXTERNAL_STORAGE的再加入申请权限列表中申请就可以了。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;但是这里READ_EXTERNAL_STORAGE，WRITE_EXTERNAL_STORAGE是一个权限组，所以申请的时候也只是提示你同意一个存储权限就可以了。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;5、Android10 — targetSdkVersion29&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;重点来了：作用域存储&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;（因为这是最容易遇到兼容性问题的地方）&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这个新功能直接颠覆了长久以来我们一直惯用的外置存储空间的使用方式，因此应用在需要运行在多系统版本的环境时，就需要实时根据当前系统版本做出相应的逻辑调整。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android长久以来都支持外置存储空间这个功能，也就是我们常说的SD卡存储。故App都喜欢在SD卡的根目录下建立一个自己专属的目录，用来存放各类文件和数据。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;优点：第一，存储在SD卡的文件不会计入到应用程序的占用空间当中，也就是说即使你在SD卡存放了1G的文件，你的应用程序在设置中显示的占用空间仍然可能只有几十K。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二，存储在SD卡的文件，即使应用程序被卸载了，这些文件仍然会被保留下来，这有助于实现一些需要数据被永久保留的功能。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;缺点：第一，流氓行为，即使我卸载了一个完全不再使用的程序，它所产生的垃圾文件却可能会一直保留在我的手机上&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二，存储在SD卡上的文件属于公有文件，所有的应用程序都有权随意访问，这也对数据的安全性带来了很大的挑战。（这种流氓行为Google他出手了，也就是作用域存储）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Google的作用域到底是什么：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 10开始，每个应用程序只能有权在自己的外置存储空间关联目录下读取和创建文件。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;获取该目录的代码为：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;context&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getExternalFilesDir&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// storage/emulated/0/Android/data/&amp;lt;包名&amp;gt;/files（大概目录为）&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;将数据存放到这个目录下，你将可以完全使用之前的写法来对文件进行读写，不需要做任何变更和适配。但同时，刚才提到的那两个“好处”也就不存在了。也就是应用删除相关存储也会消失。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;那么有些朋友可能会问了，我就是需要访问其他目录该怎么办呢？比如读取手机相册中的图片，或者向手机相册中添加一张图片。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;为此，Android系统针对文件类型进行了分类，图片、音频、视频这三类文件将可以通过MediaStore API来进行访问，而其他类型的文件则需要使用系统的文件选择器来进行访问。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;具体的适配Android10的解决方案写在下面了。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;7、Android11 — targetSdkVersion30&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;如果按照Android10的解决方案进行适配了，那么就什么都不需要做。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;如果是暂时的设置了requestLegacyExternalStorage=“true”&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt; ... &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;requestLegacyExternalStorage&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt; ...&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;那么恭喜你：Scoped Storage就会被强制启用。也就是requestLegacyExternalStorage设置无效。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;解决方案：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、按照Android10的解决方案进行适配（最好适配了。不然后续版本也要不断修改）&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、你必须在AndroidManifest.xml中声明MANAGE_EXTERNAL_STORAGE权限&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.MANAGE_EXTERNAL_STORAGE&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;tools&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ignore&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;ScopedStorage&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;注意相比于传统声明一个权限，这里增加了tools:ignore=&quot;ScopedStorage&quot;这样一个属性。因为如果不加上这个属性，Android Studio会用一个警告提醒我们，绝大部分的应用程序都不应该申请这个权限。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;之后利用ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION这个action来跳转到指定的授权页面，进行授权。（所以还是去适配Android10的解决方案吧）&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;SDK_INT&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION_CODES&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;R&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;||&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;isExternalStorageManager&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;makeText&lt;/span&gt;(&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;this&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;已获得访问所有文件权限&quot;&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;LENGTH_SHORT&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;show&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;} &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;builder&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;AlertDialog&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Builder&lt;/span&gt;(&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;this&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  .&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setMessage&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;本程序需要您同意允许访问所有文件权限&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  .&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setPositiveButton&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;确定&quot;&lt;/span&gt;) { &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;_&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Intent&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Settings&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;startActivity&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;builder&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;show&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span style=&quot;box-sizing: border-box;&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;8、Android13 — targetSdkVersion33&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、Google在Android 13上对本地数据访问权限做了更进一步的细化&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 13开始，如果你的应用targetSdk指定到了33或以上，那么READ_EXTERNAL_STORAGE权限就完全失去了作用，申请它将不会产生任何的效果。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;相对应地，Google新增了READ_MEDIA_IMAGES、READ_MEDIA_VIDEO和READ_MEDIA_AUDIO这3个运行时权限，分别用于管理手机的照片、视频和音频文件。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;也就是说，以前只要申请一个READ_EXTERNAL_STORAGE权限就可以了。现在不行了，得按需申请，用户从而能够更加精细地了解你的应用到底申请了哪些媒体权限。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.READ_MEDIA_IMAGES&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.READ_MEDIA_AUDIO&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.READ_MEDIA_VIDEO&quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、通知运行时权限&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在之前的Android系统中，任何一个应用想要发出通知的话都是不需要经过用户同意的，想发就能发。这就使得我们的手机通知栏经常被一些垃圾通知占领&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这次Android 13则把通知纳入了运行时权限管理，也就是说，以后想要发送通知，得要先经过用户同意授权才行了。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.POST_NOTIFICATIONS&quot;&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;WIFI运行时权限&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;和蓝牙类似，当开发者去访问一些WIFI相关的接口时，如热点、WIFI直连、WIFI RTT等，也需要申请地理位置权限才行。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android 13当中新增了一个NEARBY_WIFI_DEVICES权限，当再使用以上场景相关的WIFI API时，我们只需申请NEARBY_WIFI_DEVICES权限即可，从而更好地保护了用户的隐私。&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;三、Android10以上存储权限适配&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1、临时解决方案(仅适合适配到Android10)&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;临时解决方案仅仅适合在Android10上解决问题，到了Android11都是不允许的。也就是你的targetSdkVersion升级到了30就需要重新适配。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android10的临时解决方法很简单，只需要在AndroidManifest.xml中加入如下配置即可：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt; ... &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;requestLegacyExternalStorage&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt; ...&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这段配置表示，即使在Android 10系统上，仍然允许使用之前遗留的外置存储空间的用法来运行程序，这样就不用对代码进行任何修改了。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2、首先是作用域存储(上面讲到了，就不赘述)&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;简单来说就是把你原来用的获取SD卡根目录随意存储的方式，换成自己的外置存储目录。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;原来的：获取后创建自己想要的文件夹存储（Android10以上是不可以了，也就是你targetSdkVersion &amp;gt;= 29）&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getExternalStorageDirectory&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// storage/emulated/0 （正常获取的默认目录）&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;修改为：自己的外置存储空间，这就可以进行存储了&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;context&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getExternalFilesDir&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// storage/emulated/0/Android/data/&amp;lt;包名&amp;gt;/files （获取的默认目录）&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3、读取手机相册、视频、音频&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这里只举例图片，视频和音频是一样的方式获取。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;不同于过去可以直接获取到相册中图片的绝对路径，在作用域存储当中，我们只能借助MediaStore API获取到图片的Uri，示例代码如下：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;query&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Images&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Media&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;${MediaStore.MediaColumns.DATE_ADDED} desc&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;moveToNext&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getLong&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getColumnIndexOrThrow&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;_ID&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ContentUris&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;withAppendedId&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Images&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Media&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;println&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;image uri is $uri&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;cursor&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;close&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;上述代码中，我们先是通过ContentResolver获取到了相册中所有图片的id，然后再借助ContentUris将id拼装成一个完整的Uri对象。一张图片的Uri格式大致如下所示：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;content&lt;/span&gt;:&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;//media/external/images/media/321&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;那么有些朋友可能会问了，获取到了Uri之后，我又该怎样将这张图片显示出来呢？这就有很多种办法了，比如使用Glide来加载图片，它本身就支持传入Uri对象来作为图片路径：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Glide&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;with&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;context&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;load&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;into&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;imageView&lt;/span&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4、添加图片到相册(视频、音频)&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;将一张图片添加到手机相册要相对稍微复杂一点&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;直接上代码：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第一步：构建一个ContentValues对象&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二步：添加他的三个参数一个是图片显示的名称：DISPLAY_NAME。一个是图片的mime类型：MIME_TYPE。还有一个是图片存储的路径，不过这个值在Android 10和之前的系统版本中的处理方式不一样。Android 10中新增了一个RELATIVE_PATH常量，表示文件存储的相对路径，可选值有DIRECTORY_DCIM、DIRECTORY_PICTURES、DIRECTORY_MOVIES、DIRECTORY_MUSIC等，分别表示相册、图片、电影、音乐等目录。而在之前的系统版本中并没有RELATIVE_PATH，所以我们要使用DATA常量（已在Android 10中废弃），并拼装出一个文件存储的绝对路径才行。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第三步：调用ContentResolver的insert()方法即可获得插入图片的Uri。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第四步：调用ContentResolver的openOutputStream()方法获得文件的输出流，然后将Bitmap对象写入到该输出流当中即可。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;addBitmapToAlbum&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;bitmap&lt;/span&gt;: &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Bitmap&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;displayName&lt;/span&gt;: &lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;mimeType&lt;/span&gt;: &lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;compressFormat&lt;/span&gt;: &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Bitmap&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;CompressFormat&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ContentValues&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DISPLAY_NAME&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;displayName&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MIME_TYPE&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;mimeType&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;SDK_INT&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Build&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;VERSION_CODES&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Q&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;RELATIVE_PATH&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DIRECTORY_DCIM&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  } &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DATA&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;${Environment.getExternalStorageDirectory().path}/${Environment.DIRECTORY_DCIM}/$displayName&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;insert&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Images&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Media&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;openOutputStream&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;bitmap&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;compress&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;compressFormat&lt;/span&gt;, &lt;span class=&quot;cm-number&quot; style=&quot;box-sizing: border-box; color: rgb(17, 102, 68);&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;outputStream&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;close&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;5、下载文件到Download目录&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;执行文件下载操作是一个很常见的场景，比如说下载pdf、doc文件，或者下载APK安装包等等。在过去，这些文件我们通常都会下载到Download目录，这是一个专门用于存放下载文件的目录。而从Android 10开始，我们已经不能以绝对路径的方式访问外置存储空间了，所以文件下载功能也会受到影响。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第一种解决方法：同时也是最简单的一种方式，就是更改文件的下载目录。将文件下载到应用程序的关联目录下，这样不用修改任何代码就可以让程序在Android 10系统上正常工作。但使用这种方式，你需要知道，下载的文件会被计入到应用程序的占用空间当中，同时如果应用程序被卸载了，该文件也会一同被删除。另外，存放在关联目录下的文件只能被当前的应用程序所访问，其他程序是没有读取权限的。&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;第二种解决方案：&lt;/span&gt;&lt;span class=&quot;md-softbreak&quot; style=&quot;box-sizing: border-box;&quot;&gt;&#xa;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;将文件下载到Download目录，和向相册中添加一张图片的过程是差不多的，Android 10在MediaStore中新增了一种Downloads集合，专门用于执行文件下载操作。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;ContentValues&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DISPLAY_NAME&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;fileName&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;put&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaColumns&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;RELATIVE_PATH&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Environment&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DIRECTORY_DOWNLOADS&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;contentResolver&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;insert&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;MediaStore&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Downloads&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;EXTERNAL_CONTENT_URI&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;values&lt;/span&gt;)&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;其余你下载的流程不用改变，只替换你写入文件的部分&lt;/span&gt;&lt;/p&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;四、“选择启用”通知的通知权限&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 13开始通知采用“选择启用”模式，这与旧版 Android 不同，旧版 Android 采用的是“选择停用”模式。在 Android 13 中，所有应用必须先请求用户授予权限，然后才能发送通知提示。&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;实现“选择启用”通知功能所需的变更&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从 Android 13 开始，应用必须先向系统请求 &lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.com/about/versions/13/changes/notification-permission?hl=zh-cn&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;android.permission.POST_NOTIFICATION&lt;/code&gt;&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 运行时权限，以声明发送通知的意图，然后才能发送通知。&lt;/span&gt;&lt;/p&gt;&lt;figure class=&quot;md-table-fig&quot; style=&quot;box-sizing: border-box; margin: 1.2em 0px; overflow-x: auto; max-width: calc(100% + 16px); padding: 0px; cursor: default; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;table class=&quot;md-table&quot; style=&quot;box-sizing: border-box; border-collapse: collapse; border-spacing: 0px; width: 800px; overflow: auto; break-inside: auto; text-align: left; cursor: text; margin: 0px; padding: 0px; word-break: initial; white-space: pre-wrap;&quot;&gt;&lt;thead style=&quot;box-sizing: border-box; display: table-header-group; background-color: rgb(248, 248, 248);&quot;&gt;&lt;tr class=&quot;md-end-block&quot; style=&quot;box-sizing: border-box; break-inside: avoid; break-after: auto; border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px;&quot;&gt;&lt;th style=&quot;box-sizing: border-box; padding: 6px 13px; border-width: 1px 1px 0px; border-bottom-style: initial; border-bottom-color: initial; font-weight: bold; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; margin: 0px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 74px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;搭载 Android 13 的设备&lt;/span&gt;&lt;/span&gt;&lt;/th&gt;&lt;th style=&quot;box-sizing: border-box; padding: 6px 13px; border-width: 1px 1px 0px; border-bottom-style: initial; border-bottom-color: initial; font-weight: bold; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; margin: 0px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 366px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;以 Android 13 或更高版本为目标平台的应用&lt;/span&gt;&lt;/span&gt;&lt;/th&gt;&lt;th style=&quot;box-sizing: border-box; padding: 6px 13px; border-width: 1px 1px 0px; border-bottom-style: initial; border-bottom-color: initial; font-weight: bold; border-top-style: solid; border-right-style: solid; border-left-style: solid; border-top-color: rgb(223, 226, 229); border-right-color: rgb(223, 226, 229); border-left-color: rgb(223, 226, 229); border-image: initial; margin: 0px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 278px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;以低于 Android 13 的版本为目标平台的应用&lt;/span&gt;&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody style=&quot;box-sizing: border-box;&quot;&gt;&lt;tr class=&quot;md-end-block&quot; style=&quot;box-sizing: border-box; break-inside: avoid; break-after: auto; border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px;&quot;&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 74px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;新安装&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 366px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至应用发出提示。应用控制何时请求权限。&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 278px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至操作系统发出提示。首次运行应用时，系统会请求权限。&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr class=&quot;md-end-block&quot; style=&quot;box-sizing: border-box; break-inside: avoid; break-after: auto; border-top: 1px solid rgb(223, 226, 229); margin: 0px; padding: 0px; background-color: rgb(248, 248, 248);&quot;&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 74px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;现有应用（升级）&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 366px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至应用发出提示。系统将授予临时权限，直至应用在首次符合条件地运行时发出请求。&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;td style=&quot;box-sizing: border-box; padding: 6px 13px; border: 1px solid rgb(223, 226, 229); margin: 0px; min-width: 32px; text-align: left;&quot;&gt;&lt;span class=&quot;td-span&quot; style=&quot;box-sizing: border-box; display: inline-block; min-width: 1ch; width: 278px; min-height: 10px;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;系统会屏蔽通知，直至操作系统发出提示。系统会授予临时权限，直至应用首次运&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;实现：xml文件里声明 + 运行时权限申请&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1.添加通知权限&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在Android 13中，要想唤起通知，首先需要申请对应的通知权限。在应用的清单文件（AndroidManifest.xml）中添加如下代码：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;c++&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt; ...&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;android&lt;/span&gt;:&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.permission.POST_NOTIFICATIONS&quot;&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这样，你的应用就被赋予了显示通知的能力&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2. 动态请求权限&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;不仅仅是在清单文件中添加权限，还需要在显示通知之前进行动态的权限请求。以下是一个示例代码，演示了如何在动态请求权限的过程中确保用户的通知权限：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;kotlin&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;checkPermission&lt;/span&gt;() {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;manager&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getSystemService&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;NOTIFICATION_SERVICE&lt;/span&gt;) &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;NotificationManager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-comment&quot; style=&quot;box-sizing: border-box; color: rgb(170, 85, 0);&quot;&gt;// 检测该应用是否有通知权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;when&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;manager&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;areNotificationsEnabled&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&amp;gt;&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;showNotification&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;makeText&lt;/span&gt;(&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;@MainActivity&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;点击了通知按钮&quot;&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Toast&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;LENGTH_SHORT&lt;/span&gt;).&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;show&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;-&amp;gt;&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;requestPermissionLauncher&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;launch&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Manifest&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;permission&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;POST_NOTIFICATIONS&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在上述代码中，我们通过判断应用是否具备通知权限来决定是否展示通知。如果应用没有通知权限，就会触发动态请求权限的过程。&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;3.用户禁止授予权限的情景&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在某些情况下，用户可能会在第一次请求权限时选择禁止。此后，再次尝试动态请求权限就不会弹出请求弹窗。这时，我们只能引导用户手动开启相应的权限。&lt;/span&gt;&lt;/p&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;4.源码中关于应用通知权限的判断&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;Android源码中，有一段与权限相关的判断逻辑，它控制了权限的赋予。具体代码如下：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;kotlin&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;grantSignatureAppsNotificationPermissions&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;PackageManagerWrapper&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pm&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;userId&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Log&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;i&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;TAG&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;Granting Notification permissions to platform signature apps for user &quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;userId&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;PackageInfo&lt;/span&gt;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;packages&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;mContext&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getPackageManager&lt;/span&gt;().&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;getInstalledPackagesAsUser&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;DEFAULT_PACKAGE_INFO_QUERY_FLAGS&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;UserHandle&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;USER_SYSTEM&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;PackageInfo&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt; : &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;packages&lt;/span&gt;) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;cm-atom&quot; style=&quot;box-sizing: border-box; color: rgb(34, 17, 153);&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;applicationInfo&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;isSystemApp&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;applicationInfo&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;isSignedWithPlatformKey&lt;/span&gt;()) {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;continue&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;grantRuntimePermissionsForSystemPackage&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pm&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;userId&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;pkg&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;NOTIFICATION_PERMISSIONS&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;&lt;h2 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.75em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.225; cursor: text; padding-bottom: 0.3em; border-bottom: 1px solid rgb(238, 238, 238); white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;五、跨应用bindService声明软件包可见性&lt;/span&gt;&lt;/h2&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;从Android 11(api30)开始，如果应用需要与其他应用（&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#automatic&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;自动可见的&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;应用除外）交互，请在您应用的清单文件中添加 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素。在 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素中，&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#package-name&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;按软件包名称&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;、&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#intent-signature&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;按 intent 签名&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;或&lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/package-visibility#provider-authority&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;按提供程序授权&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;指定其他应用，如以下部分所述。&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;官方介绍：&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-meta-i-c md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/guide/topics/manifest/queries-element?hl=en&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;queries官方解释&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-meta-i-c md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/about/versions/12/foreground-services?hl=zh_cn&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;前台服务限制_官方&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;具体实现：&lt;/span&gt;&lt;/h3&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;1.&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;查询特定软件包及与之交互&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;如果知道要查询或与之交互的一组特定应用（例如，与应用集成的另外的应用或您使用其服务的应用），请将其软件包名称添加到 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素内的一组 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;package&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素中：&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;xml&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;package&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.test&quot;&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdke&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h4 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.25em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.4; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;2.&lt;/span&gt;&lt;span class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;strong style=&quot;box-sizing: border-box;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;在给定 intent 过滤器的情况下查询应用及与之交互&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;应用可能需要查询一组具有特定用途的应用或与之交互，但可能不知道要添加的具体软件包名称。在这种情况下，您可以在 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;queries&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素中列出 &lt;/span&gt;&lt;span class=&quot;md-meta-i-c  md-link&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;a spellcheck=&quot;false&quot; href=&quot;https://developer.android.google.cn/training/basics/intents/filters&quot; style=&quot;box-sizing: border-box; cursor: pointer; color: rgb(65, 131, 196); -webkit-user-drag: none;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;intent 过滤器签名&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;。然后，您的应用就可以发现具有匹配的 &lt;/span&gt;&lt;span spellcheck=&quot;false&quot; class=&quot;md-pair-s&quot; style=&quot;box-sizing: border-box;&quot;&gt;&lt;code style=&quot;box-sizing: border-box; font-family: var(--monospace); text-align: left; vertical-align: initial; border: 1px solid rgb(231, 234, 237); background-color: rgb(243, 244, 244); border-radius: 3px; padding: 0px 2px; font-size: 0.9em;&quot;&gt;&amp;lt;intent-filter&amp;gt;&lt;/code&gt;&lt;/span&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt; 元素的应用。&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;XML&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;package&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.test&quot;&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  ...&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;manifest&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;h3 class=&quot;md-end-block md-heading&quot; style=&quot;box-sizing: border-box; break-after: avoid-page; break-inside: avoid; orphans: 4; font-size: 1.5em; margin-top: 1rem; margin-bottom: 1rem; position: relative; font-weight: bold; line-height: 1.43; cursor: text; white-space: pre-wrap; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;示例：&lt;/span&gt;&lt;/h3&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这里只展示部分代码，重点展示如何设置软件包可见性。 &lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;服务端AndroidManifest.xml配置&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;xml&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;service&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdk.services.AidlSService&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:enabled&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:exported&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;true&quot;&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent-filter&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;category&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;android.intent.category.DEFAULT&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent-filter&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;客户端AndroidManifest.xml配置&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;package 对应服务端的包名，action 对应服务端的name&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;xml&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdk&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;cm-attribute&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 204);&quot;&gt;android:name&lt;/span&gt;=&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt; &lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;cm-tag&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;cm-tag cm-bracket&quot; style=&quot;box-sizing: border-box; color: rgb(17, 119, 0);&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;客户端跨应用启动service服务&lt;/span&gt;&lt;/p&gt;&lt;pre spellcheck=&quot;false&quot; class=&quot;md-fences md-end-block md-fences-with-lineno ty-contain-cm modeLoaded&quot; lang=&quot;java&quot; style=&quot;box-sizing: border-box; overflow: visible; font-family: var(--monospace); font-size: 0.9em; display: block; break-inside: avoid; text-align: left; white-space: normal; background-image: inherit; background-position: inherit; background-size: inherit; background-repeat: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: rgb(248, 248, 248); position: relative !important; border: 1px solid rgb(231, 234, 237); border-radius: 3px; padding: 8px 4px 6px 0px; margin-bottom: 15px; margin-top: 15px; width: inherit; color: rgb(51, 51, 51); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;cm-def&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 255);&quot;&gt;bindAidlService&lt;/span&gt;() {&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-keyword&quot; style=&quot;box-sizing: border-box; color: rgb(119, 0, 136);&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Intent&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setAction&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.payment.service&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;setPackage&lt;/span&gt;(&lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;com.cqrcb.paymentsdk&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable-3&quot; style=&quot;box-sizing: border-box; color: rgb(0, 136, 85);&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;bindService&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;intent&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;serviceConnection&lt;/span&gt;, &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Context&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;BIND_AUTO_CREATE&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;Log&lt;/span&gt;.&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;i&lt;/span&gt;(&lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;TAG&lt;/span&gt;, &lt;span class=&quot;cm-string&quot; style=&quot;box-sizing: border-box; color: rgb(170, 17, 17);&quot;&gt;&quot;bindAidlService: &quot;&lt;/span&gt; &lt;span class=&quot;cm-operator&quot; style=&quot;box-sizing: border-box; color: rgb(152, 26, 26);&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;cm-variable&quot; style=&quot;box-sizing: border-box; color: rgb(0, 0, 0);&quot;&gt;result&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span role=&quot;presentation&quot; style=&quot;box-sizing: border-box; padding-right: 0.1px;&quot;&gt; &amp;nbsp;  }&lt;/span&gt;&lt;/pre&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0.8em 0px; white-space: pre-wrap; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;这些都设置完成之后发现可能还是不能正常工作，可能是一下两个原因：&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;ol-list&quot; style=&quot;box-sizing: border-box; margin: 0.8em 0px; padding-left: 30px; position: relative; color: rgb(51, 51, 51); font-family: &amp;quot;Open Sans&amp;quot;, &amp;quot;Clear Sans&amp;quot;, &amp;quot;Helvetica Neue&amp;quot;, Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;li class=&quot;md-list-item&quot; style=&quot;box-sizing: border-box; margin: 0px; position: relative;&quot;&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px 0px 0.5rem; white-space: pre-wrap; position: relative;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;后台服务无法由另外一个应用启动，可以改为独立进程的前台服务&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li class=&quot;md-list-item&quot; style=&quot;box-sizing: border-box; margin: 0px; position: relative;&quot;&gt;&lt;p class=&quot;md-end-block md-p&quot; style=&quot;box-sizing: border-box; line-height: inherit; orphans: 4; margin: 0px 0px 0.5rem; white-space: pre-wrap; position: relative;&quot;&gt;&lt;span class=&quot;md-plain&quot; style=&quot;box-sizing: border-box;&quot;&gt;关联启动权限：需要开启对应服务的关联启动权限&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;br class=&quot;Apple-interchange-newline&quot;&gt;" id="VdQdhvA9k50GmqSqxl4O-1">
          <mxCell style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
            <mxGeometry x="40" y="20" width="940" height="9550" as="geometry" />
          </mxCell>
        </UserObject>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
